
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>Peta Rawan Pneumonia Balita di Bojonegoro</title>
    <style>
        html,
        body {
            height: 100%;
            padding: 0;
            margin: 0;
        }
        #mapid {
            height: 100%;
            width: 100vw;
        }
        
        .legend {
            padding: 6px 8px;
            font: 14px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255, 255, 255, 0.8);
            line-height: 24px;
            color: #555;
        }
        
        .legend h4 {
            text-align: center;
            font-size: 16px;
            margin: 2px 12px 8px;
            color: #777;
        }
        
        .legend span {
            position: relative;
            bottom: 3px;
        }
        
        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin: 0 8px 0 0;
            opacity: 0.7;
        }
        
        .legend i.icon {
            background-size: 18px;
            background-color: rgba(255, 255, 255, 1);
        }
    </style>

    <!-- Tell the browser to be responsive to screen width -->
     <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="lte/plugins/fontawesome-free/css/all.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="lte/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="lte/dist/css/adminlte.min.css">
    <!-- summernote -->
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <!-- search -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.bootstrap4.min.css">
    <!--leaflet-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    <script src="leaflet.ajax.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.12/js/select2.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="lte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

</head>
<body>
    <div class="container-fluid">
        <!-- Small boxes (Stat box) -->
        <div class="row">
        <div class="col-md-12">
        <input aria-label="" id="viewMap" value="0" hidden>
          <div class="card-header">
            <div class="card-tools">
              <div class="col">
                <div class="dropdown">
                  <button type="button" class="btn btn-s btn-info dropdown-toggle" data-toggle="dropdown">
                    Pilih peta yang ditampilkan
                  </button>
                  <div class="dropdown-menu" style="width: 100%">
                    
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_average_2018" > Peta Average 2018</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_average_2017" > Peta Average 2017</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_average_2016" > Peta Average 2016</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_average_2015" > Peta Average 2015</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_single_2018" > Peta Single 2018</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_single_2017" > Peta Single 2017</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_single_2016" > Peta Single 2016</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_single_2015" > Peta Single 2015</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_complete_2018" > Peta Complete 2018</label></div> 
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_complete_2017" > Peta Complete 2017</label></div>                    
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_complete_2016" > Peta Complete 2016</label></div>
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_pneumonia_complete_2015" > Peta Complete 2015</label></div>   
                    <div class="checkbox dropdown-item"><label><input type="checkbox" id="peta_kecamatan" > Peta Kecamatan</label></div>
                </div>
                </div>
              </div>
            </div>         
          </div>
          <!-- /.card-header -->
          <div id="divMap">
            <div class="row">
              <div class="col-md-12" padding-right:-10px;>     
                <div id="mapid" style="width: 100%; height: 600px"></div>
              </div>
            </div><!-- /.row -->
          </div><!-- ./card-body -->
        </div><!-- /.card -->
      </div> <!-- /.col -->
    </div> <!-- /.row -->
  </div><!-- /.container-fluid -->
    <script>
           //Menampilkan Peta
        var map = L.map('mapid').setView([-7.152341, 111.882487], 10);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
            maxZoom: 18,
            id: 'mapbox.streets',
            tileSize: 512,
            zoomOffset: -1,
            accessToken: 'pk.eyJ1Ijoicnlhbjkzc3AiLCJhIjoiY2pkMDJxZ2xpMGxjYTJxbzRtd3EzZnRzcCJ9.WsRQpljGbYjxw7za2_cPtA'
        }).addTo(map);

        //get kecamatan.json sekali aja
        var me = this;
        $.getJSON("https://dinaayufitriana.github.io/kecamatan-json/kecamatan.json", function (data) {
            me.dataKecamatan = data;
            //Layer Kecamatan
            me.kecamatanlayer = L.geoJson(me.dataKecamatan, {
                style: {
                    fillColor: "#808080",
                    fillOpacity: 0.7,
                    color: "white",
                    weight: 1,
                    opacity: 0.7
                }
            });
        
            me.kecamatanlayer.addTo(map);
        });
        //LAYER PETA KECAMATAN
        document.getElementById("peta_kecamatan").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                // document.getElementById('titleMode').innerText = 'Peta Bojonegoro';
                me.kecamatanlayer.addTo(map);
            } else {
                me.kecamatanlayer.remove(map);
            }
        });
        
        // END LAYER PETA KECAMATAN
        // LAYER PETA AVERAGE LINKAGE TAHUN 2018
        document.getElementById("peta_pneumonia_average_2018").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get averageclustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColor(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer;
        
                        function resetHighlight(e) {
                            pneumonialayer.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer = e.target;
                            layer.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer.bringToFront();
                            }
                        }
        
                        var pneumonialayer = L.geoJson(value, {
                            onEachFeature: function (feature, layer) {
                                layer.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer.getBounds());
        
                        pneumonialayer.bindPopup(function (e) {
                            return "Kecamatan = " + e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumonia(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumonia(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColor(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/averageclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2018.original));
                }
            });
        }
        // END LAYER PETA AVERAGE LINKAGE 2018
        // LAYER PETA AVERAGE LINKAGE TAHUN 2017
        document.getElementById("peta_pneumonia_average_2017").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get averageclustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorAverage2017(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_average2017;
        
                        function resetHighlight(e) {
                            pneumonialayer_average2017.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer2 = e.target;
                            layer2.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer2.bringToFront();
                            }
                        }
        
                        var pneumonialayer_average2017 = L.geoJson(value, {
                            onEachFeature: function (feature, layer2) {
                                layer2.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_average2017.getBounds());
        
                        pneumonialayer_average2017.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_average2017.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaAverage2017(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaAverage2017(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorAverage2017(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/averageclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2017.original));
                }
            });
        }
        // END LAYER PETA AVERAGE LINKAGE 2017
        // LAYER PETA AVERAGE LINKAGE TAHUN 2016
        document.getElementById("peta_pneumonia_average_2016").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get averageclustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorAverage2016(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_average2016;
        
                        function resetHighlight(e) {
                            pneumonialayer_average2016.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer3 = e.target;
                            layer3.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer3.bringToFront();
                            }
                        }
        
                        var pneumonialayer_average2016 = L.geoJson(value, {
                            onEachFeature: function (feature, layer3) {
                                layer3.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_average2016.getBounds());
        
                        pneumonialayer_average2016.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_average2016.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaAverage2016(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaAverage2016(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorAverage2016(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/averageclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2016.original));
                }
            });
        }
        // END LAYER PETA AVERAGE LINKAGE 2016
        // LAYER PETA AVERAGE LINKAGE TAHUN 2015
        document.getElementById("peta_pneumonia_average_2015").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get averageclustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorAverage2015(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_average2015;
        
                        function resetHighlight(e) {
                            pneumonialayer_average2015.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer4 = e.target;
                            layer4.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer4.bringToFront();
                            }
                        }
        
                        var pneumonialayer_average2015 = L.geoJson(value, {
                            onEachFeature: function (feature, layer4) {
                                layer4.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_average2015.getBounds());
        
                        pneumonialayer_average2015.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_average2015.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaAverage2015(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaAverage2015(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorAverage2015(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/averageclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2015.original));
                }
            });
        }
        // END LAYER PETA AVERAGE LINKAGE 2015
        // LAYER PETA SINGLE LINKAGE TAHUN 2018
        document.getElementById("peta_pneumonia_single_2018").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get single clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorSingle2018(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_single2018;
        
                        function resetHighlight(e) {
                            pneumonialayer_single2018.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer5 = e.target;
                            layer5.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer5.bringToFront();
                            }
                        }
        
                        var pneumonialayer_single2018 = L.geoJson(value, {
                            onEachFeature: function (feature, layer5) {
                                layer5.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_single2018.getBounds());
        
                        pneumonialayer_single2018.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_single2018.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaSingle2018(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaSingle2018(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorSingle2018(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/singleclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2018.original));
                }
            });
        }
        // END LAYER PETA SINGLE LINKAGE 2018
        // LAYER PETA SINGLE LINKAGE TAHUN 2017
        document.getElementById("peta_pneumonia_single_2017").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get single clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorSingle2017(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_single2017;
        
                        function resetHighlight(e) {
                            pneumonialayer_single2017.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer6 = e.target;
                            layer6.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer6.bringToFront();
                            }
                        }
        
                        var pneumonialayer_single2017 = L.geoJson(value, {
                            onEachFeature: function (feature, layer6) {
                                layer6.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature,
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_single2017.getBounds());
        
                        pneumonialayer_single2017.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_single2017.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaSingle2017(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaSingle2017(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorSingle2017(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/singleclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2017.original));
                }
            });
        }
        // END LAYER PETA SINGLE LINKAGE 2017
        // LAYER PETA SINGLE LINKAGE TAHUN 2016
        document.getElementById("peta_pneumonia_single_2016").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get single clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorSingle2016(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_single2018;
        
                        function resetHighlight(e) {
                            pneumonialayer_single2016.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer7 = e.target;
                            layer7.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer7.bringToFront();
                            }
                        }
        
                        var pneumonialayer_single2016 = L.geoJson(value, {
                            onEachFeature: function (feature, layer7) {
                                layer7.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_single2016.getBounds());
        
                        pneumonialayer_single2016.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_single2016.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaSingle2016(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaSingle2016(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorSingle2016(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/singleclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2016.original));
                }
            });
        }
        // END LAYER PETA SINGLE LINKAGE 2016
        // LAYER PETA SINGLE LINKAGE TAHUN 2015
        document.getElementById("peta_pneumonia_single_2015").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get single clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorSingle2015(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_single2015;
        
                        function resetHighlight(e) {
                            pneumonialayer_single2015.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer8 = e.target;
                            layer8.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer8.bringToFront();
                            }
                        }
        
                        var pneumonialayer_single2015 = L.geoJson(value, {
                            onEachFeature: function (feature, layer8) {
                                layer8.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_single2015.getBounds());
        
                        pneumonialayer_single2015.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_single2015.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaSingle2015(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaSingle2015(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorSingle2015(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/singleclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2015.original));
                }
            });
        }
        // END LAYER PETA SINGLE LINKAGE 2015
        // LAYER PETA COMPLETE LINKAGE TAHUN 2018
        document.getElementById("peta_pneumonia_complete_2018").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get complete clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorComplete2018(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_complete2018;
        
                        function resetHighlight(e) {
                            pneumonialayer_complete2018.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer9 = e.target;
                            layer9.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer9.bringToFront();
                            }
                        }
        
                        var pneumonialayer_complete2018 = L.geoJson(value, {
                            onEachFeature: function (feature, layer9) {
                                layer9.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_complete2018.getBounds());
        
                        pneumonialayer_complete2018.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_complete2018.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaComplete2018(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaComplete2018(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorComplete2018(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/completeclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2018.original));
                }
            });
        }
        // END LAYER PETA COMPLETE LINKAGE 2018
        // LAYER PETA COMPLETE LINKAGE TAHUN 2017
        document.getElementById("peta_pneumonia_complete_2017").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get complete clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorComplete2017(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_complete2017;
        
                        function resetHighlight(e) {
                            pneumonialayer_complete2017.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer10 = e.target;
                            layer10.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer10.bringToFront();
                            }
                        }
        
                        var pneumonialayer_complete2017 = L.geoJson(value, {
                            onEachFeature: function (feature, layer10) {
                                layer10.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_complete2017.getBounds());
        
                        pneumonialayer_complete2017.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_complete2017.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaComplete2017(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaComplete2017(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorComplete2017(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/completeclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2017.original));
                }
            });
        }
        // END LAYER PETA COMPLETE LINKAGE 2017
        // LAYER PETA COMPLETE LINKAGE TAHUN 2016
        document.getElementById("peta_pneumonia_complete_2016").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get complete clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorComplete2016(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_complete2016;
        
                        function resetHighlight(e) {
                            pneumonialayer_complete2016.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer11 = e.target;
                            layer11.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer11.bringToFront();
                            }
                        }
        
                        var pneumonialayer_complete2016 = L.geoJson(value, {
                            onEachFeature: function (feature, layer11) {
                                layer11.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_complete2016.getBounds());
        
                        pneumonialayer_complete2016.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_complete2016.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaComplete2016(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaComplete2016(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorComplete2016(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/completeclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2016.original));
                }
            });
        }
        // END LAYER PETA COMPLETE LINKAGE 2016
        // LAYER PETA COMPLETE LINKAGE TAHUN 2015
        document.getElementById("peta_pneumonia_complete_2015").addEventListener("change", function () {
            if (document.getElementById(this.id).checked == true) {
                //untuk menampilkan peta kecamatan.json
        
                // $.getJSON("/js/kecamatan.json", function(data) {
        
                //get data pneumonia sekali aja soalnya sama2 get complete clustering, yang buat lemot gara2 ini ditaruh di dalam loop
        
                getPneumoniaColorComplete2015(function (dataPneumonia) {
        
        
                    $.each((me.dataKecamatan.features), function (index, value) {
        
                        var kecamatan = value.properties.id_kecamatan;
        
        
                        var kasus = getKasus(dataPneumonia, kecamatan);
        
                        var pneumonialayer_complete2015;
        
                        function resetHighlight(e) {
                            pneumonialayer_complete2015.resetStyle(e.target);
                        }
        
                        function zoomToFeature(e) {
                            map.fitBounds(e.target.getBounds());
                        }
        
                        function highlightFeature(e) {
                            var layer12 = e.target;
                            layer12.setStyle({
                                weight: 5,
                                color: '#666',
                                dashArray: '',
                                fillOpacity: 0.7
                            });
                            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                                layer12.bringToFront();
                            }
                        }
        
                        var pneumonialayer_complete2015 = L.geoJson(value, {
                            onEachFeature: function (feature, layer12) {
                                layer12.on({
                                    mouseover: highlightFeature,
                                    mouseout: resetHighlight,
                                    click: zoomToFeature
                                });
                            },
                            style: function (feature) {
                                return {
                                    weight: 2,
                                    opacity: 1,
                                    color: 'white',
                                    dashArray: '3',
                                    fillOpacity: 0.7,
                                    fillColor: kasus['warna']
                                };
                            }
        
                        }).addTo(map);
                        map.fitBounds(pneumonialayer_complete2015.getBounds());
        
                        pneumonialayer_complete2015.bindPopup(function (e) {
                            return "Kecamatan = " +e.feature.properties.Kecamatan + " <br> Jumlah Balita = " + kasus['jumlah_balita'] + " <br> Penderita = " + kasus['jumlah_penderita'];
                        });
        
                    });
        
                });
        
            } else {
                pneumonialayer_complete2015.remove(map);
            }
        });
        //untuk memberi warna
        
        function getKasus(data, kecamatan) {
            var kasus = {};
        
            $.each(JSON.parse(data), function (num, item) {
                //manggil array di clestering controller untuk disamakan dengan id_kecamatan di geojson
                if (kecamatan == item['0']) {
                    var color = item['15'];
                    // init kasus
                    kasus['warna'] = getColorPneumoniaComplete2015(color);
                    kasus['jumlah_balita'] = item['3'];
                    kasus['jumlah_penderita'] = item['2'];
        
                    return kasus;
                }
            });
        
            return kasus;
        }
        function getColorPneumoniaComplete2015(warna) {
            return 'Tinggi' == warna ? '#d64337' :
                'Sedang' == warna ? '#ffff00' :
                'Rendah' == warna ? '#006600' :
                '#baf1a1';
        }
        
        function getPneumoniaColorComplete2015(handleData) {
            //jadi data api dipanggil disini
            $.ajax({
                type: 'GET',
                url: 'https://thawing-scrubland-62223.herokuapp.com/admin/completeclustering',
                dataType: 'json',
                success: function (data) {
                    //disimpan dilocal storage datanya agar bisa dipanggil
                    //  localStorage.removeItem('dataPneumonia');
                    // localStorage.setItem('dataPneumonia', JSON.stringify(data.data2018.original));
                    // tidak perlu disimpan distorage karena tidak pernah dipanggil
                
                    handleData(JSON.stringify(data.data2015.original));
                }
            });
        }
        // END LAYER PETA COMPLETE LINKAGE 2015
        //Legend pada Peta
        var legend = L.control({
            position: 'bottomleft'
        });
        legend.onAdd = function(map) {

            var div = L.DomUtil.create('div', 'legend');
            div.innerHTML += "<h4>Keterangan Warna</h4>";
            div.innerHTML += '<i style="background: #d64337"></i><span>Tinggi</span><br>';
            div.innerHTML += '<i style="background: #ffff00"></i><span>Sedang</span><br>';
            div.innerHTML += '<i style="background: #006600"></i><span>Rendah</span><br>';

            return div;
        };

        legend.addTo(map);
    </script>
</body>
</html>